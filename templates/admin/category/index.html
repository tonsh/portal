<%inherit file="../base.html" />

<%def name="header_content()">
    <link rel="stylesheet" href="${static_url('js/treeview/jquery.treeview.css')}" />
    <script type="text/javascript" src="${static_url('js/treeview/jquery.treeview.js')}"></script>    

    <script type="text/javascript">
     $(function() {
         $("#category_tree").treeview({
             collapsed:  true,
             animated:   "medium",
             control:    "#control_tree",
             persist:    "location",
         });
     });
    </script>
</%def>

<%def name="body_content()">
    <p>
        ${_('分类管理')}
        <a href="/admin/category/add">${_('添加分类')}</a>
    </p>

    <div id="control_tree">
        <a href="#?">${_('收起')}</a>
        <a href="#?">${_('展开')}</a>
    </div>

    <ul id="category_tree">
        ${reshow_category(categories)}
    </ul>
</%def>

<%def name="reshow_category(categories)">
    %for cid, category in categories.items():
        <%
            info = category['info']
            children = category.get('children', None)
        %>
        <li>
            <a href="#${info.id}">${info.title}</a>
            %if children:
                <ul>
                    ${reshow_category(children)}
                </ul>
            %endif
        </li>
    %endfor
</%def>
